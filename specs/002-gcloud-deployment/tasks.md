# Tasks: Google Cloud Run éƒ¨ç½²

**Input**: Design documents from `/specs/002-gcloud-deployment/`
**Prerequisites**: plan.md, spec.md, research.md, data-model.md, contracts/

**Tests**: æœ¬åŠŸèƒ½åŒ…å«éƒ¨ç½²é©—è­‰æ¸¬è©¦ï¼Œç¢ºä¿æ¯å€‹ User Story éƒ½æœ‰å°æ‡‰çš„é©—è­‰æ©Ÿåˆ¶ã€‚

**Organization**: ä»»å‹™ä¾ User Story çµ„ç¹”ï¼Œä½¿æ¯å€‹ Story éƒ½èƒ½ç¨ç«‹å¯¦ä½œå’Œæ¸¬è©¦ã€‚

## Format: `[ID] [P?] [Story] Description`

- **[P]**: å¯å¹³è¡ŒåŸ·è¡Œï¼ˆä¸åŒæª”æ¡ˆï¼Œç„¡ä¾è³´ï¼‰
- **[Story]**: æ­¤ä»»å‹™å±¬æ–¼å“ªå€‹ User Storyï¼ˆå¦‚ US1, US2, US3ï¼‰
- åŒ…å«å®Œæ•´æª”æ¡ˆè·¯å¾‘

## Path Conventions

æœ¬å°ˆæ¡ˆç‚º Web æ‡‰ç”¨ç¨‹å¼æ¶æ§‹ï¼š
- **Backend**: `backend/src/`, `backend/tests/`
- **Frontend**: `frontend/src/`, `frontend/tests/`
- **Scripts**: `scripts/deploy/`
- **Docs**: `docs/deployment/`

---

## Phase 1: Setup (å…±ç”¨åŸºç¤è¨­æ–½)

**ç›®çš„**: å°ˆæ¡ˆåˆå§‹åŒ–å’ŒåŸºæœ¬çµæ§‹å»ºç«‹

- [ ] T001 å»ºç«‹éƒ¨ç½²è…³æœ¬ç›®éŒ„ `scripts/deploy/`
- [ ] T002 [P] å»ºç«‹éƒ¨ç½²è¨­å®šç›®éŒ„ `scripts/deploy/config/`
- [x] T003 [P] å»ºç«‹ `.env.deploy.template` ç’°å¢ƒè®Šæ•¸ç¯„æœ¬æª”æ¡ˆåœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ *(å·²å»ºç«‹ .env.deploy)*
- [x] T004 [P] å°‡ `.env.deploy` åŠ å…¥ `.gitignore` *(å·²å®Œæˆ)*
- [x] T005 [P] é©—è­‰ gcloud CLI å·²å®‰è£ä¸¦è¨­å®šå°ˆæ¡ˆ `three-birds-on-mountain` *(å·²å®Œæˆ)*

---

## Phase 2: Foundational (é˜»å¡æ€§å‰ç½®æ¢ä»¶)

**ç›®çš„**: æ‰€æœ‰ User Story éƒ½ä¾è³´çš„æ ¸å¿ƒåŸºç¤è¨­æ–½

**âš ï¸ é‡è¦**: æ­¤éšæ®µå¿…é ˆå®Œæˆå¾Œæ‰èƒ½é–‹å§‹ä»»ä½• User Story çš„å¯¦ä½œ

### å¾Œç«¯åŸºç¤è¨­æ–½

- [ ] T006 æ›´æ–° `backend/src/core/config.py` ä»¥æ”¯æ´ Cloud Run ç’°å¢ƒè®Šæ•¸ï¼ˆDATABASE_URL, CORS_ORIGINS, LOG_LEVEL ç­‰ï¼‰
- [ ] T007 æ›´æ–° `backend/src/db/session.py` ä»¥æ”¯æ´ Unix socket è³‡æ–™åº«é€£ç·š
- [x] T008 [P] ç¢ºèª `backend/src/api/health.py` health endpoint å®Œæ•´æ€§ï¼ˆå›æ‡‰ database é€£ç·šç‹€æ…‹ï¼‰ *(å·²é©—è­‰æ­£å¸¸é‹ä½œ)*
- [x] T009 æ›´æ–° `backend/Dockerfile` éµå¾ª Cloud Run æœ€ä½³å¯¦è¸ï¼ˆmulti-stage build, uv package managerï¼‰ *(å·²ä¿®æ­£ PORT ç’°å¢ƒè®Šæ•¸)*

### å‰ç«¯åŸºç¤è¨­æ–½

- [ ] T010 [P] å»ºç«‹ `frontend/Dockerfile` ç”¨æ–¼ Vite å»ºç½®å’Œ nginx æœå‹™
- [ ] T011 [P] å»ºç«‹ `frontend/cloudbuild.yaml` ç”¨æ–¼ Cloud Build å»ºç½®æµç¨‹
- [ ] T012 [P] å»ºç«‹ `frontend/docker/nginx.conf` ç”¨æ–¼ SPA è·¯ç”±å’Œå®‰å…¨æ¨™é ­

### GCP è³‡æºæº–å‚™

- [x] T013 é©—è­‰ Artifact Registry repository `containers` å·²å»ºç«‹åœ¨ `asia-east1` *(å·²å®Œæˆ)*
- [x] T014 é©—è­‰ Cloud SQL å¯¦ä¾‹ `tpml-seat-tracker-db` å¯ç”¨ä¸”é‹è¡Œä¸­ *(å·²å®Œæˆ)*
- [x] T015 [P] å»ºç«‹è³‡æ–™åº« `road_safety_db` åœ¨ Cloud SQL å¯¦ä¾‹ä¸­ï¼ˆå¦‚æœªå»ºç«‹ï¼‰ *(å·²å®Œæˆ)*
- [x] T016 [P] å»ºç«‹è³‡æ–™åº«ä½¿ç”¨è€… `road_safety_user` åœ¨ Cloud SQL å¯¦ä¾‹ä¸­ï¼ˆå¦‚æœªå»ºç«‹ï¼‰ *(å·²å®Œæˆ)*

**Checkpoint**: åŸºç¤å°±ç·’ - User Story å¯¦ä½œç¾åœ¨å¯ä»¥å¹³è¡Œé–‹å§‹

---

## Phase 3: User Story 1 - éƒ¨ç½²å¾Œç«¯æœå‹™åˆ° Cloud Run (Priority: P1) ğŸ¯ MVP

**Goal**: å¾Œç«¯ FastAPI æœå‹™æˆåŠŸéƒ¨ç½²åˆ° Cloud Runï¼Œä¸¦é€é Unix socket é€£æ¥åˆ° Cloud SQL

**Independent Test**: é€é `curl https://[SERVICE_URL]/api/v1/health` é©—è­‰æœå‹™é‹è¡Œä¸”è³‡æ–™åº«é€£ç·šæ­£å¸¸ï¼Œå›æ‡‰åŒ…å« `"database": "connected"`

### å¯¦ä½œ User Story 1

- [ ] T017 [US1] å»ºç«‹éƒ¨ç½²è…³æœ¬ `scripts/deploy/deploy-backend.sh`
- [x] T018 [US1] åœ¨éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œ Docker æ˜ åƒå»ºç½®é‚è¼¯ï¼ˆä½¿ç”¨ Cloud Buildï¼‰ *(å·²æ‰‹å‹•åŸ·è¡Œ gcloud builds submit)*
- [x] T019 [US1] åœ¨éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œ Cloud Run éƒ¨ç½²é‚è¼¯ï¼ˆè¨­å®šç’°å¢ƒè®Šæ•¸ã€è³‡æºé™åˆ¶ã€Cloud SQL é€£ç·šï¼‰ *(å·²æ‰‹å‹•åŸ·è¡Œ gcloud run deploy)*
- [ ] T020 [US1] åœ¨éƒ¨ç½²è…³æœ¬ä¸­åŠ å…¥éŒ¯èª¤è™•ç†å’Œé€²åº¦é¡¯ç¤º
- [x] T021 [US1] åŸ·è¡Œéƒ¨ç½²è…³æœ¬ä¸¦å–å¾—å¾Œç«¯æœå‹™ URL *(URL: https://road-safety-backend-303764303193.asia-east1.run.app)*
- [x] T022 [US1] é©—è­‰å¾Œç«¯ health endpoint å›æ‡‰æ­£å¸¸ï¼ˆdatabase: connectedï¼‰ *(å·²é©—è­‰ï¼šstatus=healthy, database=connected)*
- [ ] T023 [US1] é©—è­‰å¾Œç«¯ API endpoints é‹ä½œæ­£å¸¸ï¼ˆå¦‚ `/api/v1/hotspots/nearby`ï¼‰
- [x] T024 [US1] è¨˜éŒ„å¾Œç«¯æœå‹™ URL åˆ°æ–‡ä»¶æˆ–ç’°å¢ƒè®Šæ•¸ *(å·²è¨˜éŒ„åœ¨ BACKEND_DEPLOYMENT.md)*

**Checkpoint**: æ­¤æ™‚ User Story 1 æ‡‰è©²å®Œå…¨åŠŸèƒ½æ­£å¸¸ä¸”å¯ç¨ç«‹æ¸¬è©¦

---

## Phase 4: User Story 2 - éƒ¨ç½²å‰ç«¯æœå‹™åˆ° Cloud Run (Priority: P2)

**Goal**: å‰ç«¯ React/Vite æ‡‰ç”¨ç¨‹å¼æˆåŠŸéƒ¨ç½²åˆ° Cloud Runï¼Œæ­£ç¢ºè¨­å®šå¾Œç«¯ API URL å’Œ Mapbox token

**Independent Test**: é€éç€è¦½å™¨å­˜å–å‰ç«¯ URLï¼Œç¢ºèªé é¢è¼‰å…¥ã€åœ°åœ–é¡¯ç¤ºã€API å‘¼å«éƒ½æ­£å¸¸é‹ä½œ

### å¯¦ä½œ User Story 2

- [ ] T025 [US2] å»ºç«‹éƒ¨ç½²è…³æœ¬ `scripts/deploy/deploy-frontend.sh`
- [ ] T026 [US2] åœ¨éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œå–å¾—å¾Œç«¯ URL é‚è¼¯
- [ ] T027 [US2] åœ¨éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œ Docker æ˜ åƒå»ºç½®é‚è¼¯ï¼ˆä½¿ç”¨ Cloud Build + æ³¨å…¥ç’°å¢ƒè®Šæ•¸ï¼‰
- [ ] T028 [US2] åœ¨éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œ Cloud Run éƒ¨ç½²é‚è¼¯ï¼ˆè¨­å®š port=80, è³‡æºé™åˆ¶ï¼‰
- [ ] T029 [US2] åœ¨éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œæ›´æ–°å¾Œç«¯ CORS è¨­å®šé‚è¼¯ï¼ˆä½¿ç”¨å‰ç«¯ URLï¼‰
- [ ] T030 [US2] åŸ·è¡Œéƒ¨ç½²è…³æœ¬ä¸¦å–å¾—å‰ç«¯æœå‹™ URL
- [ ] T031 [US2] é©—è­‰å‰ç«¯é é¢è¼‰å…¥æˆåŠŸï¼ˆHTTP 200ï¼‰
- [ ] T032 [US2] é©—è­‰å‰ç«¯éœæ…‹è³‡æºè¼‰å…¥æ­£å¸¸ï¼ˆæª¢æŸ¥ Cache-Control æ¨™é ­ï¼‰
- [ ] T033 [US2] é©—è­‰å‰ç«¯å¯å‘¼å«å¾Œç«¯ APIï¼ˆç„¡ CORS éŒ¯èª¤ï¼‰
- [ ] T034 [US2] é©—è­‰åœ°åœ–å…ƒä»¶æ­£å¸¸é¡¯ç¤ºï¼ˆMapbox token æ­£ç¢ºï¼‰

**Checkpoint**: User Stories 1 å’Œ 2 éƒ½æ‡‰è©²ç¨ç«‹é‹ä½œæ­£å¸¸

---

## Phase 5: User Story 3 - åŸ·è¡Œè³‡æ–™åº« Migration (Priority: P1)

**Goal**: è³‡æ–™åº« schema æˆåŠŸåˆå§‹åŒ–æˆ–æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬

**Independent Test**: é€éé€£ç·šåˆ° Cloud SQL ä¸¦æŸ¥è©¢è³‡æ–™è¡¨åˆ—è¡¨ä¾†é©—è­‰ migration æˆåŠŸåŸ·è¡Œ

**Note**: æ­¤ User Story èˆ‡ US1 åŒç‚º P1 å„ªå…ˆç´šï¼Œä½†å¯¦éš›ä¸Šæ‡‰è©²åœ¨ US1 ä¹‹å‰åŸ·è¡Œï¼ˆä½œç‚ºå‰ç½®æ¢ä»¶ï¼‰

### å¯¦ä½œ User Story 3

- [ ] T035 [US3] é©—è­‰ Cloud SQL Proxy å·²å®‰è£ï¼ˆè‹¥æœªå®‰è£å‰‡æä¾›å®‰è£æŒ‡ä»¤ï¼‰
- [ ] T036 [US3] å»ºç«‹ migration åŸ·è¡Œè…³æœ¬ `scripts/deploy/run-migration.sh`
- [ ] T037 [US3] åœ¨è…³æœ¬ä¸­å¯¦ä½œå•Ÿå‹• Cloud SQL Proxy é‚è¼¯
- [ ] T038 [US3] åœ¨è…³æœ¬ä¸­å¯¦ä½œç­‰å¾… Proxy å°±ç·’é‚è¼¯
- [ ] T039 [US3] åœ¨è…³æœ¬ä¸­å¯¦ä½œåŸ·è¡Œ Alembic migration é‚è¼¯ï¼ˆ`alembic upgrade head`ï¼‰
- [ ] T040 [US3] åœ¨è…³æœ¬ä¸­å¯¦ä½œé©—è­‰ migration æˆåŠŸé‚è¼¯ï¼ˆæŸ¥è©¢ alembic_versionï¼‰
- [ ] T041 [US3] åœ¨è…³æœ¬ä¸­å¯¦ä½œé—œé–‰ Cloud SQL Proxy é‚è¼¯
- [ ] T042 [US3] åŸ·è¡Œ migration è…³æœ¬
- [ ] T043 [US3] é©—è­‰è³‡æ–™è¡¨å·²æ­£ç¢ºå»ºç«‹ï¼ˆé€é Cloud SQL Proxy é€£ç·šæŸ¥è©¢ï¼‰
- [ ] T044 [US3] é©—è­‰ alembic_version è¡¨å·²æ›´æ–°

**Checkpoint**: è³‡æ–™åº« schema å·²æº–å‚™å¥½ï¼ŒUser Story 1 (å¾Œç«¯éƒ¨ç½²) ç¾åœ¨å¯ä»¥ä½¿ç”¨

---

## Phase 6: User Story 4 - æ›´æ–°å·²éƒ¨ç½²çš„æœå‹™ (Priority: P2)

**Goal**: é–‹ç™¼è€…å¯ä»¥é‡æ–°éƒ¨ç½²æœå‹™ä¸¦ç¢ºä¿ä¸å½±éŸ¿ç¾æœ‰è³‡æ–™å’Œæœå‹™å¯ç”¨æ€§

**Independent Test**: ä¿®æ”¹ç°¡å–®çš„ç¨‹å¼ç¢¼ï¼ˆå¦‚æ–°å¢ä¸€å€‹ API endpointï¼‰ï¼Œé‡æ–°éƒ¨ç½²ï¼Œç„¶å¾Œé©—è­‰æ–°åŠŸèƒ½å¯ç”¨ä¸”èˆŠåŠŸèƒ½ä¸å—å½±éŸ¿

### å¯¦ä½œ User Story 4

- [ ] T045 [US4] å»ºç«‹æœå‹™æ›´æ–°è…³æœ¬ `scripts/deploy/update-backend.sh`ï¼ˆé‡æ–°å»ºç½®ä¸¦éƒ¨ç½²å¾Œç«¯ï¼‰
- [ ] T046 [US4] å»ºç«‹æœå‹™æ›´æ–°è…³æœ¬ `scripts/deploy/update-frontend.sh`ï¼ˆé‡æ–°å»ºç½®ä¸¦éƒ¨ç½²å‰ç«¯ï¼‰
- [ ] T047 [US4] å»ºç«‹ç’°å¢ƒè®Šæ•¸æ›´æ–°è…³æœ¬ `scripts/deploy/update-env-vars.sh`
- [ ] T048 [US4] åœ¨æ›´æ–°è…³æœ¬ä¸­åŠ å…¥æ»¾å‹•éƒ¨ç½²é‚è¼¯ï¼ˆæœ€å°åŒ–æœå‹™ä¸­æ–·ï¼‰
- [ ] T049 [US4] æ¸¬è©¦å¾Œç«¯æ›´æ–°æµç¨‹ï¼ˆä¿®æ”¹ä¸€å€‹å°åŠŸèƒ½ä¸¦é‡æ–°éƒ¨ç½²ï¼‰
- [ ] T050 [US4] æ¸¬è©¦å‰ç«¯æ›´æ–°æµç¨‹ï¼ˆä¿®æ”¹ä¸€å€‹å°åŠŸèƒ½ä¸¦é‡æ–°éƒ¨ç½²ï¼‰
- [ ] T051 [US4] é©—è­‰æ›´æ–°å¾Œæœå‹™ä¸­æ–·æ™‚é–“ < 10 ç§’
- [ ] T052 [US4] æ¸¬è©¦ç’°å¢ƒè®Šæ•¸æ›´æ–°æµç¨‹ï¼ˆæ›´æ–° CORS_ORIGINSï¼‰
- [ ] T053 [US4] æ¸¬è©¦è³‡æ–™åº« migration æ›´æ–°æµç¨‹ï¼ˆå»ºç«‹æ–° migration ä¸¦åŸ·è¡Œï¼‰

**Checkpoint**: æœå‹™æ›´æ–°æ©Ÿåˆ¶å·²é©—è­‰ï¼Œå¯ä»¥å®‰å…¨åœ°è¿­ä»£é–‹ç™¼

---

## Phase 7: User Story 5 - ç›£æ§å’Œé™¤éŒ¯éƒ¨ç½²å•é¡Œ (Priority: P3)

**Goal**: é–‹ç™¼è€…å¯ä»¥æŸ¥çœ‹æœå‹™æ—¥èªŒå’Œç‹€æ…‹ä¾†è¨ºæ–·å’Œè§£æ±ºéƒ¨ç½²æˆ–é‹è¡Œæ™‚å•é¡Œ

**Independent Test**: æ•…æ„å¼•å…¥ä¸€å€‹éŒ¯èª¤ï¼ˆå¦‚éŒ¯èª¤çš„è³‡æ–™åº«å¯†ç¢¼ï¼‰ï¼Œéƒ¨ç½²å¾Œé€éæŸ¥çœ‹æ—¥èªŒä¾†å®šä½å•é¡Œ

### å¯¦ä½œ User Story 5

- [ ] T054 [P] [US5] å»ºç«‹æ—¥èªŒæŸ¥è©¢è…³æœ¬ `scripts/deploy/view-logs.sh`ï¼ˆæ”¯æ´éæ¿¾åƒæ•¸ï¼‰
- [ ] T055 [P] [US5] å»ºç«‹æœå‹™ç‹€æ…‹æŸ¥è©¢è…³æœ¬ `scripts/deploy/check-status.sh`
- [ ] T056 [P] [US5] å»ºç«‹å¸¸è¦‹å•é¡Œæ’æŸ¥è…³æœ¬ `scripts/deploy/troubleshoot.sh`
- [ ] T057 [US5] åœ¨æ—¥èªŒè…³æœ¬ä¸­å¯¦ä½œæŸ¥çœ‹å¾Œç«¯æ—¥èªŒé‚è¼¯
- [ ] T058 [US5] åœ¨æ—¥èªŒè…³æœ¬ä¸­å¯¦ä½œæŸ¥çœ‹å‰ç«¯æ—¥èªŒé‚è¼¯
- [ ] T059 [US5] åœ¨æ—¥èªŒè…³æœ¬ä¸­å¯¦ä½œéæ¿¾éŒ¯èª¤æ—¥èªŒé‚è¼¯
- [ ] T060 [US5] åœ¨ç‹€æ…‹è…³æœ¬ä¸­å¯¦ä½œæŸ¥çœ‹æœå‹™è©³ç´°è³‡è¨Šé‚è¼¯
- [ ] T061 [US5] åœ¨ç‹€æ…‹è…³æœ¬ä¸­å¯¦ä½œæŸ¥çœ‹è³‡æºä½¿ç”¨æƒ…æ³é‚è¼¯
- [ ] T062 [US5] æ¸¬è©¦æ—¥èªŒæŸ¥è©¢åŠŸèƒ½ï¼ˆæŸ¥çœ‹æœ€è¿‘ 50 æ¢æ—¥èªŒï¼‰
- [ ] T063 [US5] æ¸¬è©¦éŒ¯èª¤å®šä½åŠŸèƒ½ï¼ˆå¼•å…¥éŒ¯èª¤ä¸¦é€éæ—¥èªŒæ‰¾åˆ°åŸå› ï¼‰

**Checkpoint**: ç›£æ§å’Œé™¤éŒ¯å·¥å…·å·²æº–å‚™å¥½ï¼Œå¯ä»¥å¿«é€Ÿè¨ºæ–·å•é¡Œ

---

## Phase 8: æ•´åˆå’Œé©—è­‰

**ç›®çš„**: å»ºç«‹å®Œæ•´éƒ¨ç½²æµç¨‹å’Œé©—è­‰æ©Ÿåˆ¶

### å®Œæ•´éƒ¨ç½²æµç¨‹

- [ ] T064 å»ºç«‹å®Œæ•´éƒ¨ç½²è…³æœ¬ `scripts/deploy/deploy-all.sh`ï¼ˆæ•´åˆ migration + backend + frontendï¼‰
- [ ] T065 åœ¨å®Œæ•´éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œæ­¥é©Ÿ 1: åŸ·è¡Œ migration
- [ ] T066 åœ¨å®Œæ•´éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œæ­¥é©Ÿ 2: éƒ¨ç½²å¾Œç«¯
- [ ] T067 åœ¨å®Œæ•´éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œæ­¥é©Ÿ 3: é©—è­‰å¾Œç«¯
- [ ] T068 åœ¨å®Œæ•´éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œæ­¥é©Ÿ 4: éƒ¨ç½²å‰ç«¯ï¼ˆä½¿ç”¨å¾Œç«¯ URLï¼‰
- [ ] T069 åœ¨å®Œæ•´éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œæ­¥é©Ÿ 5: é©—è­‰å‰ç«¯
- [ ] T070 åœ¨å®Œæ•´éƒ¨ç½²è…³æœ¬ä¸­å¯¦ä½œæ­¥é©Ÿ 6: é©—è­‰æ•´åˆ
- [ ] T071 åœ¨å®Œæ•´éƒ¨ç½²è…³æœ¬ä¸­åŠ å…¥éŒ¯èª¤è™•ç†ï¼ˆä»»ä¸€æ­¥é©Ÿå¤±æ•—å‰‡åœæ­¢ï¼‰

### é©—è­‰æ©Ÿåˆ¶

- [ ] T072 [P] å»ºç«‹é©—è­‰è…³æœ¬ `scripts/deploy/verify-deployment.sh`
- [ ] T073 [P] åœ¨é©—è­‰è…³æœ¬ä¸­å¯¦ä½œå¾Œç«¯ health check é©—è­‰
- [ ] T074 [P] åœ¨é©—è­‰è…³æœ¬ä¸­å¯¦ä½œå¾Œç«¯ API endpoints é©—è­‰
- [ ] T075 [P] åœ¨é©—è­‰è…³æœ¬ä¸­å¯¦ä½œå‰ç«¯é é¢è¼‰å…¥é©—è­‰
- [ ] T076 [P] åœ¨é©—è­‰è…³æœ¬ä¸­å¯¦ä½œ CORS æ•´åˆé©—è­‰
- [ ] T077 [P] åœ¨é©—è­‰è…³æœ¬ä¸­å¯¦ä½œå›æ‡‰æ™‚é–“é©—è­‰ï¼ˆhealth < 2sï¼‰
- [ ] T078 åŸ·è¡Œå®Œæ•´éƒ¨ç½²æµç¨‹ä¸€æ¬¡ï¼ˆclean deploymentï¼‰
- [ ] T079 åŸ·è¡Œé©—è­‰è…³æœ¬ç¢ºèªæ‰€æœ‰æª¢æŸ¥é€šé

---

## Phase 9: æ–‡ä»¶å’Œæœ€ä½³åŒ–

**ç›®çš„**: å®Œå–„æ–‡ä»¶ã€å„ªåŒ–è…³æœ¬ã€æå‡ä½¿ç”¨è€…é«”é©—

### éƒ¨ç½²æ–‡ä»¶

- [x] T080 [P] å»ºç«‹éƒ¨ç½²æ“ä½œæ‰‹å†Š `docs/deployment/SMART_ROAD_DEPLOYMENT.md` *(å·²å»ºç«‹ BACKEND_DEPLOYMENT.md å’Œ QUICK_REFERENCE.md)*
- [x] T081 [P] åœ¨éƒ¨ç½²æ–‡ä»¶ä¸­è¨˜éŒ„å‰ç½®éœ€æ±‚ï¼ˆgcloud CLI, Cloud SQL Proxyï¼‰ *(å·²å®Œæˆ)*
- [x] T082 [P] åœ¨éƒ¨ç½²æ–‡ä»¶ä¸­è¨˜éŒ„ç’°å¢ƒè®Šæ•¸è¨­å®š *(å·²å®Œæˆ)*
- [x] T083 [P] åœ¨éƒ¨ç½²æ–‡ä»¶ä¸­è¨˜éŒ„å®Œæ•´éƒ¨ç½²æ­¥é©Ÿ *(å·²å®Œæˆ)*
- [x] T084 [P] åœ¨éƒ¨ç½²æ–‡ä»¶ä¸­è¨˜éŒ„å¸¸è¦‹å•é¡Œå’Œè§£æ±ºæ–¹æ¡ˆ *(å·²å®Œæˆï¼ŒåŒ…å« 6 å€‹å¸¸è¦‹å•é¡Œ)*
- [x] T085 [P] åœ¨éƒ¨ç½²æ–‡ä»¶ä¸­è¨˜éŒ„ç›£æ§å’Œæ—¥èªŒæŸ¥è©¢æ–¹æ³• *(å·²å®Œæˆ)*

### è…³æœ¬æœ€ä½³åŒ–

- [ ] T086 [P] ç‚ºæ‰€æœ‰è…³æœ¬åŠ å…¥çµ±ä¸€çš„è¼¸å‡ºæ ¼å¼ï¼ˆâœ“ æˆåŠŸ, âœ— éŒ¯èª¤ï¼‰
- [ ] T087 [P] ç‚ºæ‰€æœ‰è…³æœ¬åŠ å…¥ `--help` åƒæ•¸é¡¯ç¤ºä½¿ç”¨èªªæ˜
- [ ] T088 [P] ç‚ºæ‰€æœ‰è…³æœ¬åŠ å…¥ `--verbose` åƒæ•¸é¡¯ç¤ºè©³ç´°è¼¸å‡º
- [ ] T089 [P] ç‚ºæ‰€æœ‰è…³æœ¬åŠ å…¥éŒ¯èª¤ç¢¼å®šç¾©ï¼ˆE001, E002 ç­‰ï¼‰
- [ ] T090 [P] ç‚ºæ‰€æœ‰è…³æœ¬åŠ å…¥å‰ç½®æ¢ä»¶æª¢æŸ¥ï¼ˆgcloud èªè­‰ã€å¿…è¦ç’°å¢ƒè®Šæ•¸ç­‰ï¼‰

### è¨­å®šç®¡ç†

- [ ] T091 [P] å»ºç«‹å¾Œç«¯éƒ¨ç½²è¨­å®šæª” `scripts/deploy/config/backend.json`
- [ ] T092 [P] å»ºç«‹å‰ç«¯éƒ¨ç½²è¨­å®šæª” `scripts/deploy/config/frontend.json`
- [ ] T093 [P] å»ºç«‹ migration è¨­å®šæª” `scripts/deploy/config/migration.json`
- [ ] T094 [P] æ›´æ–°è…³æœ¬ä»¥ä½¿ç”¨è¨­å®šæª”ï¼ˆè€Œéç¡¬ç·¨ç¢¼å€¼ï¼‰

### README å’Œä½¿ç”¨èªªæ˜

- [ ] T095 [P] å»ºç«‹è…³æœ¬ä½¿ç”¨èªªæ˜ `scripts/deploy/README.md`
- [ ] T096 [P] åœ¨ README ä¸­åŠ å…¥å¿«é€Ÿé–‹å§‹æŒ‡å—ï¼ˆ5 åˆ†é˜éƒ¨ç½²ï¼‰
- [ ] T097 [P] åœ¨ README ä¸­åŠ å…¥è…³æœ¬åˆ—è¡¨å’Œç”¨é€”èªªæ˜
- [ ] T098 [P] åœ¨ README ä¸­åŠ å…¥æ•…éšœæ’é™¤æŒ‡å—
- [ ] T099 æ›´æ–°å°ˆæ¡ˆæ ¹ç›®éŒ„ `README.md` åŠ å…¥éƒ¨ç½²ç« ç¯€ï¼ˆé€£çµåˆ°è©³ç´°æ–‡ä»¶ï¼‰

---

## Phase 10: Polish & Cross-Cutting Concerns

**ç›®çš„**: æœ€çµ‚å„ªåŒ–å’Œå“è³ªä¿è­‰

- [ ] T100 [P] å¯©æŸ¥æ‰€æœ‰è…³æœ¬çš„éŒ¯èª¤è™•ç†é‚è¼¯
- [ ] T101 [P] å¯©æŸ¥æ‰€æœ‰è…³æœ¬çš„åƒæ•¸é©—è­‰é‚è¼¯
- [ ] T102 [P] å¯©æŸ¥æ‰€æœ‰éƒ¨ç½²è¨­å®šæª”çš„å®Œæ•´æ€§
- [ ] T103 [P] åŸ·è¡Œå®Œæ•´éƒ¨ç½²æµç¨‹æ¸¬è©¦ï¼ˆå¾é›¶é–‹å§‹åˆ°å®Œæ•´éƒ¨ç½²ï¼‰
- [ ] T104 [P] åŸ·è¡Œé‡æ–°éƒ¨ç½²æ¸¬è©¦ï¼ˆæ¨¡æ“¬æ›´æ–°å ´æ™¯ï¼‰
- [ ] T105 [P] åŸ·è¡ŒéŒ¯èª¤æ¢å¾©æ¸¬è©¦ï¼ˆéƒ¨ç½²å¤±æ•—å¾Œèƒ½å¦æ¢å¾©ï¼‰
- [ ] T106 [P] é©—è­‰æ‰€æœ‰æ–‡ä»¶çš„æº–ç¢ºæ€§å’Œå®Œæ•´æ€§
- [ ] T107 [P] å»ºç«‹éƒ¨ç½² checklist `docs/deployment/DEPLOYMENT_CHECKLIST.md`
- [ ] T108 [P] åŸ·è¡Œ quickstart.md é©—è­‰ï¼ˆæŒ‰ç…§æ–‡ä»¶æ­¥é©Ÿå®Œæ•´åŸ·è¡Œä¸€æ¬¡ï¼‰
- [ ] T109 è¨˜éŒ„éƒ¨ç½²æ™‚é–“æŒ‡æ¨™ï¼ˆmigration, backend, frontend å„éœ€è¦å¤šä¹…ï¼‰
- [ ] T110 è¨˜éŒ„æˆæœ¬ä¼°ç®—ï¼ˆCloud Run, Cloud Build, Artifact Registry è²»ç”¨ï¼‰

---

## Dependencies & Execution Order

### Phase Dependencies

- **Setup (Phase 1)**: ç„¡ä¾è³´ - å¯ç«‹å³é–‹å§‹
- **Foundational (Phase 2)**: ä¾è³´ Setup å®Œæˆ - é˜»å¡æ‰€æœ‰ User Stories
- **User Story 3 (Phase 5 - Migration)**: ä¾è³´ Foundational å®Œæˆ - æ‡‰åœ¨ US1 ä¹‹å‰åŸ·è¡Œ
- **User Story 1 (Phase 3 - å¾Œç«¯éƒ¨ç½²)**: ä¾è³´ Foundational + US3 å®Œæˆ
- **User Story 2 (Phase 4 - å‰ç«¯éƒ¨ç½²)**: ä¾è³´ US1 å®Œæˆï¼ˆéœ€è¦å¾Œç«¯ URLï¼‰
- **User Story 4 (Phase 6 - æ›´æ–°æœå‹™)**: ä¾è³´ US1 å’Œ US2 å®Œæˆ
- **User Story 5 (Phase 7 - ç›£æ§)**: å¯èˆ‡å…¶ä»– User Stories å¹³è¡Œï¼Œä½†å»ºè­°åœ¨ US1 å®Œæˆå¾Œ
- **Integration (Phase 8)**: ä¾è³´ US1, US2, US3 å®Œæˆ
- **Documentation (Phase 9)**: å¯èˆ‡å¯¦ä½œå¹³è¡Œé€²è¡Œ
- **Polish (Phase 10)**: ä¾è³´æ‰€æœ‰ User Stories å®Œæˆ

### User Story Dependencies

**å»ºè­°åŸ·è¡Œé †åº** (è€ƒæ…®å¯¦éš›ä¾è³´é—œä¿‚):
1. **User Story 3 (Migration)** - å¿…é ˆæœ€å…ˆåŸ·è¡Œï¼Œæº–å‚™è³‡æ–™åº«
2. **User Story 1 (å¾Œç«¯éƒ¨ç½²)** - ä¾è³´ US3ï¼Œæä¾› API æœå‹™
3. **User Story 2 (å‰ç«¯éƒ¨ç½²)** - ä¾è³´ US1ï¼Œå–å¾—å¾Œç«¯ URL
4. **User Story 4 (æ›´æ–°æœå‹™)** - ä¾è³´ US1 å’Œ US2
5. **User Story 5 (ç›£æ§)** - å¯å¹³è¡Œï¼Œä½†æœ‰æœå‹™å¾Œæ›´æœ‰æ„ç¾©

### Within Each User Story

- Migration (US3) â†’ Backend (US1) â†’ Frontend (US2) â†’ Update (US4) â†’ Monitor (US5)
- Setup å’Œ Foundational å¿…é ˆæœ€å…ˆå®Œæˆ
- æ ¸å¿ƒå¯¦ä½œå®Œæˆå¾Œå†é€²è¡Œé©—è­‰

### Parallel Opportunities

- **Phase 1 (Setup)**: T001-T005 å¯å¹³è¡ŒåŸ·è¡Œï¼ˆæ¨™è¨˜ [P]ï¼‰
- **Phase 2 (Foundational)**:
  - T008, T010, T011, T012, T013, T014, T015, T016 å¯å¹³è¡ŒåŸ·è¡Œ
- **Phase 9 (Documentation)**: T080-T099 å¹¾ä¹å…¨éƒ¨å¯å¹³è¡ŒåŸ·è¡Œ
- **ä¸åŒ User Stories**: ç†è«–ä¸Šå¯å¹³è¡Œï¼Œä½†å¯¦å‹™ä¸Šæœ‰é †åºä¾è³´ï¼ˆUS3 â†’ US1 â†’ US2ï¼‰

---

## Parallel Example: Phase 2 (Foundational)

```bash
# åŒæ™‚å»ºç«‹å‰ç«¯ç›¸é—œæª”æ¡ˆï¼š
Task: "å»ºç«‹ frontend/Dockerfile ç”¨æ–¼ Vite å»ºç½®å’Œ nginx æœå‹™"
Task: "å»ºç«‹ frontend/cloudbuild.yaml ç”¨æ–¼ Cloud Build å»ºç½®æµç¨‹"
Task: "å»ºç«‹ frontend/docker/nginx.conf ç”¨æ–¼ SPA è·¯ç”±å’Œå®‰å…¨æ¨™é ­"

# åŒæ™‚é€²è¡Œ GCP è³‡æºæº–å‚™ï¼š
Task: "é©—è­‰ Artifact Registry repository containers å·²å»ºç«‹"
Task: "å»ºç«‹è³‡æ–™åº« road_safety_db åœ¨ Cloud SQL å¯¦ä¾‹ä¸­"
Task: "å»ºç«‹è³‡æ–™åº«ä½¿ç”¨è€… road_safety_user åœ¨ Cloud SQL å¯¦ä¾‹ä¸­"
```

---

## Implementation Strategy

### MVP First (User Story 3 + 1 + 2 = æœ€å°å¯è¡Œç”¢å“)

1. Complete Phase 1: Setup
2. Complete Phase 2: Foundational (CRITICAL - é˜»å¡æ‰€æœ‰ stories)
3. Complete Phase 5: User Story 3 (Migration) - æº–å‚™è³‡æ–™åº«
4. Complete Phase 3: User Story 1 (å¾Œç«¯éƒ¨ç½²) - æä¾› API
5. **STOP and VALIDATE**: æ¸¬è©¦å¾Œç«¯ç¨ç«‹é‹ä½œ
6. Complete Phase 4: User Story 2 (å‰ç«¯éƒ¨ç½²) - å®Œæ•´æ‡‰ç”¨
7. **STOP and VALIDATE**: æ¸¬è©¦å‰å¾Œç«¯æ•´åˆ
8. éƒ¨ç½²/Demoï¼ˆMVP å®Œæˆï¼ï¼‰

### Incremental Delivery

1. Setup + Foundational â†’ åŸºç¤å°±ç·’
2. Add US3 (Migration) â†’ è³‡æ–™åº«å°±ç·’
3. Add US1 (å¾Œç«¯) â†’ æ¸¬è©¦ç¨ç«‹é‹ä½œ â†’ å¯éƒ¨ç½²å¾Œç«¯ API
4. Add US2 (å‰ç«¯) â†’ æ¸¬è©¦æ•´åˆ â†’ éƒ¨ç½²/Demoï¼ˆMVPï¼ï¼‰
5. Add US4 (æ›´æ–°æ©Ÿåˆ¶) â†’ æ¸¬è©¦é‡æ–°éƒ¨ç½² â†’ æŒçºŒè¿­ä»£èƒ½åŠ›
6. Add US5 (ç›£æ§) â†’ æ¸¬è©¦å•é¡Œè¨ºæ–· â†’ å®Œæ•´ç¶­è­·èƒ½åŠ›
7. æ¯å€‹ story éƒ½å¢åŠ åƒ¹å€¼ä¸”ä¸ç ´å£å…ˆå‰çš„åŠŸèƒ½

### Parallel Team Strategy

å–®äººé–‹ç™¼è€…ï¼ˆå»ºè­°ï¼‰:
1. ä¾åºå®Œæˆ Setup + Foundational
2. ä¾åºå®Œæˆ US3 â†’ US1 â†’ US2ï¼ˆå› ç‚ºæœ‰ä¾è³´é—œä¿‚ï¼‰
3. US4 å’Œ US5 å¯åœ¨ US2 å®Œæˆå¾Œå¹³è¡Œé–‹å§‹ï¼ˆå¦‚æ™‚é–“å…è¨±ï¼‰

å¤šäººåœ˜éšŠï¼ˆå¦‚æœ‰ï¼‰:
1. å…¨å“¡å®Œæˆ Setup + Foundational
2. Developer A: US3 (Migration)
3. Developer B: æº–å‚™ US1 çš„è…³æœ¬ï¼ˆç­‰ US3 å®Œæˆå¾ŒåŸ·è¡Œï¼‰
4. Developer C: US5 (ç›£æ§å·¥å…·) - å¯å¹³è¡Œé–‹ç™¼
5. US3 å®Œæˆå¾Œ â†’ A æ”¯æ´ B å®Œæˆ US1 â†’ ä¸€èµ·å®Œæˆ US2
6. æœ€å¾Œä¸€èµ·å®Œæˆ US4 å’Œæ•´åˆæ¸¬è©¦

---

## Notes

- [P] ä»»å‹™ = ä¸åŒæª”æ¡ˆï¼Œç„¡ä¾è³´
- [Story] æ¨™ç±¤å°‡ä»»å‹™å°æ‡‰åˆ°ç‰¹å®š User Storyï¼Œä¾¿æ–¼è¿½è¹¤
- æ¯å€‹ User Story éƒ½æ‡‰è©²å¯ç¨ç«‹å®Œæˆå’Œæ¸¬è©¦
- åœ¨æ¯å€‹ checkpoint åœä¸‹ä¾†é©—è­‰ story ç¨ç«‹é‹ä½œ
- é¿å…ï¼šæ¨¡ç³Šçš„ä»»å‹™ã€ç›¸åŒæª”æ¡ˆè¡çªã€ç ´å£ç¨ç«‹æ€§çš„è·¨ story ä¾è³´
- éƒ¨ç½²åŠŸèƒ½çš„ç‰¹æ®Šæ€§ï¼šUser Stories ä¹‹é–“æœ‰å¯¦éš›çš„é †åºä¾è³´ï¼ˆUS3 â†’ US1 â†’ US2ï¼‰ï¼Œä½†æ¯å€‹éƒ½èƒ½ç¨ç«‹é©—è­‰å…¶åŠŸèƒ½
- Migration (US3) é›–ç„¶æ¨™è¨˜ç‚º P1ï¼Œä½†å¯¦éš›ä¸Šæ˜¯æ‰€æœ‰éƒ¨ç½²çš„å‰ç½®æ¢ä»¶
- é‡é»åœ¨æ–¼ï¼šæ¯å®Œæˆä¸€å€‹ User Story éƒ½èƒ½ç«‹å³é©—è­‰å…¶åŠŸèƒ½ï¼Œä¸éœ€è¦ç­‰æ‰€æœ‰åŠŸèƒ½å®Œæˆ

---

**ä»»å‹™ç¸½æ•¸**: 110 å€‹ä»»å‹™
**é ä¼°ç¸½æ™‚é–“**: 15-20 å°æ™‚ï¼ˆåŒ…å«æ¸¬è©¦å’Œæ–‡ä»¶ï¼‰
**MVP ç¯„åœ**: Phase 1-5ï¼ˆSetup + Foundational + US3 + US1 + US2ï¼‰ç´„ 50 å€‹ä»»å‹™ï¼Œ8-10 å°æ™‚
